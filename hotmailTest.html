<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="constants.js" type="text/javascript" language="javascript"></script>
    <script src="https://js.live.net/v5.0/wl.debug.js" type="text/javascript" language="javascript"></script>
</head>
    <body>
        <div id="signin"></div>
        <script type="text/javascript" language="javascript">
            var APPLICATION_CLIENT_ID = "000000004805D048";
			var REDIRECT_URL = "http://www.conferenceapp.com/";
			
			WL.Event.subscribe("auth.login", onLoginComplete);
            WL.init({
                client_id: APPLICATION_CLIENT_ID,
                redirect_uri: REDIRECT_URL,
                response_type: "token"                    
            });
            var scopesArr = ["wl.signin", "wl.events_create"];
            WL.ui({
                name: "signin",
                element: "signin",
                scope: scopesArr
            });
                        
            function onLoginComplete(session) {
                if (!session.error) {
                    var scopes = "";                
                    for (i = 0; i < session.session.scope.length; i++) {
                        scopes = scopes + session.session.scope[i] + " ";
                    }                
                    alert("Signed in with scope(s) " + scopes);
                    WL.api({
                        path: "me/events",
                        method: "POST",
                        body: {
                            name: "Family Dinner",
                            description: "Dinner with Cynthia's family",
                            start_time: "2011-03-22T01:30:00-08:00",
                            end_time: "2011-03-22T03:00:00-08:00",
                            location: "Coho Vineyard and Winery, 123 Main St., Redmond WA 19532",
                            is_all_day_event: false,
                            availability: "busy",
                            visibility: "public"
                        }
                    }, onAPICalled); 
                }
                else {
                    alert("Error signing in: " + session.error.message);
                }
            }
 
            function onAPICalled(result) {                
                if (!result.error) {
                    alert("Successfully created event.");
                }
                else {
                    alert("Error creating event: " + result.error.message);
                }                
            }            
        </script>                
    </body>
</html>